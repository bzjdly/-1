# 完成日志：敌人碰撞伤害、血量与击退状态优化

## 项目结构
- `Enemy.cs` 进行了多项优化，包括血量系统、撞墙与互撞伤害、击退状态控制和速度衰减调节。
- `Bullet.cs` 修改了击中敌人时调用 `OnHit` 的传参。
- `PlayerMovement.cs` 新增了血量系统。
- 新增或修改了多个资产文件（预制体、Tile Palette、Sprite等）。

## 系统实现逻辑
1. **敌人血量系统**：敌人和玩家都拥有血量，受击会扣血，敌人血量为0时销毁，玩家血量为0时控制台输出死亡信息。
2. **子弹优化**：子弹速度随飞行距离衰减，低于阈值不造成伤害；撞墙反弹并损失动能；击中敌人根据子弹速度造成击退和伤害。
3. **敌人撞墙伤害**：敌人以超过设定速度撞到墙壁时会根据动能受到伤害，并立即停止移动，结束击退状态。
4. **敌人互撞伤害**：敌人之间以超过设定相对速度碰撞时，会相互根据动能造成伤害并触发受击反馈（闪烁、击退停顿、粒子），物理弹开由Rigidbody2D处理。
5. **敌人击退状态与恢复**：
   - 敌人被带有方向的攻击击中时进入击退状态，暂停追踪玩家。
   - 击退期间 Rigidbody2D 的线性阻力增加，导致速度更快衰减，衰减倍率可调。
   - 击退状态在撞墙或击退停顿时间结束且速度接近零时恢复，敌人重新开始追踪玩家。

## 数据结构
- `Enemy`：包含血量、墙壁与互撞伤害阈值/倍率、击退停顿时间、击退阻力倍率、原始阻力、击退状态标志等。
- `PlayerMovement`：包含血量相关字段。
- `Bullet`：包含速度衰减、最低伤害速度、撞墙反弹系数、击退基准系数等。

## 目录
- 项目结构与节点说明：包含在之前的日志和本次总结中。
- 各系统实现细节：包含在各脚本和本次总结中。
- 完成日志列表：
  - 完成日志_玩家与喷子结构.md
  - 完成日志_打击感与方向震动.md
  - 完成日志_摄像机跟随与边界限制.md
  - 完成日志_敌人系统与调度.md
  - 完成日志_敌人受击粒子系统移除.md
  - 完成日志_敌人血量与击退调节.md
  - 完成日志_瓦片地图基础结构.md
  - 本次完成日志（即将生成）

## 用户需要操作的重点
- 在Unity Inspector中设置玩家和敌人的最大血量（maxHP）。
- 调试敌人的 `minWallImpactSpeed`、`wallDamageMultiplier`、`minEnemyImpactSpeed`、`enemyDamageMultiplier` 等碰撞伤害参数。
- 调试敌人的 `hitStopTime` 和 `knockbackDragMultiplier` 参数，优化击退停顿和速度衰减手感。
- 确保瓦片地图的墙体Layer为"Wall"。
- 确保所有敌人Tag为"Enemy"。
- 在EnemyManager上拖拽赋值玩家Transform。
- 为Enemy预制体设置受击粒子预制体（Unity ParticleSystem）。
- 继续完成瓦片地图的绘制。
