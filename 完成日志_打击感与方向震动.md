# 完成日志：打击感与方向震动 & 喷子全弹命中停顿

## 项目结构
- 打击感脚本 `HitFeedback.cs` 位于 `Assets/Scripts/` 文件夹。
- 修改 `GunShoot.cs`，为发射的子弹增加批量标识和总数量信息。
- 修改 `Bullet.cs`，使其携带批量信息并在击中敌人时传递。
- 修改 `Enemy.cs`，增加批量击中计数和全弹命中判断逻辑。
- `HitFeedback.cs` 脚本可挂载在场景任意物体（如 CameraManager）。

## 系统实现逻辑
1. `HitFeedback` 采用单例模式，其他脚本可通过 `HitFeedback.Instance` 方便调用。
2. 支持多种打击感效果：
   - 普通摄像机震动（CameraShake）
   - 方向震动（DirectionalShake）：主方向正弦震动+小幅度垂直抖动，方向和幅度可配置
   - 摄像机缩放（CameraZoom/ResetZoom）
   - 游戏慢动作（SlowMotion）
3. **喷子全弹命中停顿**：
   - `GunShoot` 为每次射击生成唯一的批量ID，并知道本批次发射的总子弹数。
   - 子弹 (`Bullet`) 实例化时被赋予其所属的批量ID和总数量。
   - 子弹击中敌人时，调用敌人 (`Enemy`) 的方法，传递批量ID和总数量。
   - 敌人维护一个字典，记录每个批量ID的子弹击中自身的次数。
   - 当同一批量ID的子弹击中次数达到该批次的总子弹数量时，判断为全弹命中。
   - 全弹命中时，通过 `HitFeedback.Instance.SlowMotion()` 触发游戏时间变慢效果，增强打击感。
4. 所有参数分组并有中文注释，Inspector面板可调，调用时也可传参覆盖。
5. 方向震动可用于近战、爆炸、击退等需要方向感的打击反馈。

## 数据结构
- `HitFeedback` 公开变量：
  - 震动、方向震动、缩放、慢动作相关参数
- `HitFeedback` 主要方法：
  - `CameraShake()` 普通震动
  - `DirectionalShake()` 方向震动
  - `CameraZoom()/ResetZoom()` 缩放与恢复
  - `SlowMotion()` 慢动作
- `GunShoot` 新增 `shootBatchCounter` (静态int)。
- `Bullet` 新增 `shootBatchID` (int) 和 `totalBulletsInBatch` (int)，新增公共方法 `SetShootBatchInfo()`。
- `Enemy` 新增 `bulletBatchHits` (Dictionary<int, int>)，新增公共方法 `OnBulletHitBatch()`。

## 目录
- 项目结构与节点说明：本日志
- 敌人生成机制：完成日志_敌人生成机制.md
- 敌人寻路与流场AI：完成日志_敌人寻路与流场AI.md
- 打击感与方向震动 & 喷子全弹命中停顿实现细节：本日志已包含
- 其他系统日志（根据需要列出）

## 用户需要操作的重点
- 确保场景中存在一个挂载了 `HitFeedback.cs` 脚本的 GameObject，且主摄像机为 Camera.main。
- `GunShoot` 和 `Bullet` 脚本会自动配合工作。
- 敌人 (`Enemy`) 脚本会自动接收并处理批量击中信息。
- 可在 `HitFeedback` 的 Inspector 面板中调整慢动作（SlowMotion）的参数来优化效果。

现在，当玩家使用喷子全弹命中同一个敌人时，应该会触发时间变慢的效果。

## 示例用法
```csharp
// 普通震动
HitFeedback.Instance.CameraShake();
// 方向震动（向上，主幅度0.5，左右幅度0.1，持续0.2秒）
HitFeedback.Instance.DirectionalShake(Vector2.up, 0.5f, 0.1f, 0.2f, Vector2.right);
// 缩放
HitFeedback.Instance.CameraZoom(3.5f, 8f);
// 恢复缩放
HitFeedback.Instance.ResetZoom();
// 慢动作
HitFeedback.Instance.SlowMotion(0.3f, 0.15f);
``` 